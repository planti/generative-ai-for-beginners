<!--
CO_OP_TRANSLATOR_METADATA:
{
  "original_hash": "d46aad0917a1a342d613e2c13d457da5",
  "translation_date": "2025-05-19T18:31:01+00:00",
  "source_file": "08-building-search-applications/README.md",
  "language_code": "th"
}
-->
# การสร้างแอปพลิเคชันการค้นหา

> > _คลิกที่ภาพด้านบนเพื่อดูวิดีโอของบทเรียนนี้_

LLMs ไม่ได้มีแค่แชทบอทและการสร้างข้อความเท่านั้น เรายังสามารถสร้างแอปพลิเคชันการค้นหาโดยใช้ Embeddings ได้ด้วย Embeddings เป็นการแสดงข้อมูลเชิงตัวเลขที่เรียกว่าวิคเตอร์ และสามารถใช้สำหรับการค้นหาเชิงความหมายของข้อมูลได้

ในบทเรียนนี้ คุณจะได้สร้างแอปพลิเคชันการค้นหาสำหรับสตาร์ทอัพด้านการศึกษาของเรา สตาร์ทอัพของเราเป็นองค์กรไม่แสวงหาผลกำไรที่ให้การศึกษาฟรีแก่เด็กนักเรียนในประเทศกำลังพัฒนา สตาร์ทอัพของเรามีวิดีโอ YouTube จำนวนมากที่นักเรียนสามารถใช้เรียนรู้เกี่ยวกับ AI สตาร์ทอัพของเราต้องการสร้างแอปพลิเคชันการค้นหาที่ให้นักเรียนค้นหาวิดีโอ YouTube ได้โดยการพิมพ์คำถาม

ตัวอย่างเช่น นักเรียนอาจพิมพ์ 'Jupyter Notebooks คืออะไร?' หรือ 'Azure ML คืออะไร?' และแอปพลิเคชันการค้นหาจะคืนรายการวิดีโอ YouTube ที่เกี่ยวข้องกับคำถามนั้น และดียิ่งขึ้น แอปพลิเคชันการค้นหาจะคืนลิงก์ไปยังจุดในวิดีโอที่มีคำตอบสำหรับคำถามนั้น

## บทนำ

ในบทเรียนนี้ เราจะครอบคลุม:

- การค้นหาเชิงความหมาย vs การค้นหาด้วยคีย์เวิร์ด
- Text Embeddings คืออะไร
- การสร้างดัชนี Text Embeddings
- การค้นหาดัชนี Text Embeddings

## เป้าหมายการเรียนรู้

หลังจากจบบทเรียนนี้ คุณจะสามารถ:

- แยกแยะระหว่างการค้นหาเชิงความหมายและการค้นหาด้วยคีย์เวิร์ด
- อธิบายว่า Text Embeddings คืออะไร
- สร้างแอปพลิเคชันโดยใช้ Embeddings ในการค้นหาข้อมูล

## ทำไมต้องสร้างแอปพลิเคชันการค้นหา?

การสร้างแอปพลิเคชันการค้นหาจะช่วยให้คุณเข้าใจวิธีการใช้ Embeddings ในการค้นหาข้อมูล นอกจากนี้คุณยังจะได้เรียนรู้วิธีสร้างแอปพลิเคชันการค้นหาที่นักเรียนสามารถใช้ค้นหาข้อมูลได้อย่างรวดเร็ว

บทเรียนนี้มีดัชนี Embedding ของบทถอดเสียง YouTube สำหรับช่อง Microsoft [AI Show](https://www.youtube.com/playlist?list=PLlrxD0HtieHi0mwteKBOfEeOYf0LJU4O1) ดัชนี Embedding ประกอบด้วย Embeddings สำหรับแต่ละบทถอดเสียง YouTube จนถึงเดือนตุลาคม 2023 คุณจะใช้ดัชนี Embedding เพื่อสร้างแอปพลิเคชันการค้นหาสำหรับสตาร์ทอัพของเรา แอปพลิเคชันการค้นหาจะคืนลิงก์ไปยังจุดในวิดีโอที่มีคำตอบสำหรับคำถาม นี่เป็นวิธีที่ดีสำหรับนักเรียนในการค้นหาข้อมูลที่ต้องการได้อย่างรวดเร็ว

ตัวอย่างต่อไปนี้คือการค้นหาเชิงความหมายสำหรับคำถาม 'คุณสามารถใช้ rstudio กับ azure ml ได้หรือไม่?' ลองดูที่ URL ของ YouTube คุณจะเห็นว่า URL นั้นมี timestamp ที่นำคุณไปยังจุดในวิดีโอที่มีคำตอบสำหรับคำถาม

## การค้นหาเชิงความหมายคืออะไร?

ตอนนี้คุณอาจสงสัยว่าการค้นหาเชิงความหมายคืออะไร การค้นหาเชิงความหมายคือเทคนิคการค้นหาที่ใช้ความหมายของคำในคำค้นหาเพื่อคืนผลลัพธ์ที่เกี่ยวข้อง

นี่คือตัวอย่างของการค้นหาเชิงความหมาย สมมติว่าคุณกำลังมองหาซื้อรถ คุณอาจค้นหาว่า 'รถในฝันของฉัน' การค้นหาเชิงความหมายเข้าใจว่าคุณไม่ได้ `dreaming` เกี่ยวกับรถ แต่คุณกำลังมองหาซื้อรถ `ideal` ของคุณ การค้นหาเชิงความหมายเข้าใจเจตนาของคุณและคืนผลลัพธ์ที่เกี่ยวข้อง ทางเลือกคือ `keyword search` ซึ่งจะค้นหาเกี่ยวกับความฝันของรถจริง ๆ และมักคืนผลลัพธ์ที่ไม่เกี่ยวข้อง

## Text Embeddings คืออะไร?

[Text embeddings](https://en.wikipedia.org/wiki/Word_embedding?WT.mc_id=academic-105485-koreyst) เป็นเทคนิคการแสดงข้อความที่ใช้ใน [การประมวลผลภาษาธรรมชาติ](https://en.wikipedia.org/wiki/Natural_language_processing?WT.mc_id=academic-105485-koreyst) Text embeddings เป็นการแสดงข้อมูลเชิงตัวเลขเชิงความหมายของข้อความ Embeddings ถูกใช้เพื่อแสดงข้อมูลในรูปแบบที่เครื่องจักรเข้าใจได้ง่าย มีหลายโมเดลสำหรับการสร้าง text embeddings ในบทเรียนนี้ เราจะเน้นการสร้าง embeddings โดยใช้ OpenAI Embedding Model

ตัวอย่างเช่น ลองจินตนาการว่าข้อความต่อไปนี้อยู่ในบทถอดเสียงจากหนึ่งในตอนของช่อง AI Show บน YouTube:

```text
Today we are going to learn about Azure Machine Learning.
```

เราจะส่งข้อความไปยัง OpenAI Embedding API และมันจะคืน embedding ที่ประกอบด้วยตัวเลข 1536 ตัว หรือที่เรียกว่าวิคเตอร์ แต่ละตัวเลขในวิคเตอร์แสดงถึงแง่มุมต่าง ๆ ของข้อความ เพื่อความกระชับ นี่คือตัวเลข 10 ตัวแรกในวิคเตอร์

```python
[-0.006655829958617687, 0.0026128944009542465, 0.008792596869170666, -0.02446001023054123, -0.008540431968867779, 0.022071078419685364, -0.010703742504119873, 0.003311325330287218, -0.011632772162556648, -0.02187200076878071, ...]
```

## ดัชนี Embedding ถูกสร้างขึ้นอย่างไร?

ดัชนี Embedding สำหรับบทเรียนนี้ถูกสร้างขึ้นด้วยชุดของสคริปต์ Python คุณจะพบสคริปต์พร้อมคำแนะนำใน [README](./scripts/README.md?WT.mc_id=academic-105485-koreyst) ในโฟลเดอร์ 'scripts' สำหรับบทเรียนนี้ คุณไม่จำเป็นต้องรันสคริปต์เหล่านี้เพื่อจบบทเรียนนี้เนื่องจากดัชนี Embedding ถูกจัดเตรียมไว้ให้คุณแล้ว

สคริปต์ดำเนินการดังต่อไปนี้:

1. ดาวน์โหลดบทถอดเสียงสำหรับแต่ละวิดีโอ YouTube ในรายการเล่น [AI Show](https://www.youtube.com/playlist?list=PLlrxD0HtieHi0mwteKBOfEeOYf0LJU4O1)
2. ใช้ [OpenAI Functions](https://learn.microsoft.com/azure/ai-services/openai/how-to/function-calling?WT.mc_id=academic-105485-koreyst) พยายามสกัดชื่อผู้พูดจาก 3 นาทีแรกของบทถอดเสียง YouTube ชื่อผู้พูดสำหรับแต่ละวิดีโอจะถูกจัดเก็บในดัชนี Embedding ที่ชื่อว่า `embedding_index_3m.json`
3. ข้อความบทถอดเสียงจะถูกแบ่งเป็น **ส่วนข้อความ 3 นาที** ส่วนข้อความจะมีคำประมาณ 20 คำที่ทับซ้อนจากส่วนถัดไปเพื่อให้แน่ใจว่า Embedding สำหรับส่วนนี้จะไม่ถูกตัดออกและเพื่อให้มีบริบทการค้นหาที่ดียิ่งขึ้น
4. แต่ละส่วนข้อความจะถูกส่งไปยัง OpenAI Chat API เพื่อสรุปข้อความให้เป็น 60 คำ สรุปนี้จะถูกจัดเก็บในดัชนี Embedding `embedding_index_3m.json`
5. สุดท้าย ส่วนข้อความจะถูกส่งไปยัง OpenAI Embedding API Embedding API จะคืนวิคเตอร์ที่ประกอบด้วยตัวเลข 1536 ตัวที่แสดงถึงความหมายเชิงความหมายของส่วนนี้ ส่วนข้อความพร้อมกับ OpenAI Embedding วิคเตอร์จะถูกจัดเก็บในดัชนี Embedding `embedding_index_3m.json`

### ฐานข้อมูลวิคเตอร์

เพื่อความเรียบง่ายในบทเรียน ดัชนี Embedding จะถูกจัดเก็บในไฟล์ JSON ชื่อ `embedding_index_3m.json` และโหลดเข้าสู่ Pandas DataFrame อย่างไรก็ตาม ในการผลิตจริง ดัชนี Embedding จะถูกจัดเก็บในฐานข้อมูลวิคเตอร์ เช่น [Azure Cognitive Search](https://learn.microsoft.com/training/modules/improve-search-results-vector-search?WT.mc_id=academic-105485-koreyst), [Redis](https://cookbook.openai.com/examples/vector_databases/redis/readme?WT.mc_id=academic-105485-koreyst), [Pinecone](https://cookbook.openai.com/examples/vector_databases/pinecone/readme?WT.mc_id=academic-105485-koreyst), [Weaviate](https://cookbook.openai.com/examples/vector_databases/weaviate/readme?WT.mc_id=academic-105485-koreyst) เป็นต้น

## การทำความเข้าใจความคล้ายคลึงของโคไซน์

เราได้เรียนรู้เกี่ยวกับ text embeddings แล้ว ขั้นตอนต่อไปคือการเรียนรู้วิธีใช้ text embeddings ในการค้นหาข้อมูลและโดยเฉพาะการหาการฝังที่คล้ายที่สุดกับคำค้นหาที่กำหนดโดยใช้ความคล้ายคลึงของโคไซน์

### ความคล้ายคลึงของโคไซน์คืออะไร?

ความคล้ายคลึงของโคไซน์คือการวัดความคล้ายคลึงระหว่างสองวิคเตอร์ คุณอาจได้ยินว่าเรียกว่า `nearest neighbor search` เพื่อทำการค้นหาความคล้ายคลึงของโคไซน์ คุณจำเป็นต้อง _vectorize_ ข้อความ _query_ โดยใช้ OpenAI Embedding API จากนั้นคำนวณ _cosine similarity_ ระหว่างวิคเตอร์คำค้นหาและแต่ละวิคเตอร์ในดัชนี Embedding จำไว้ว่า ดัชนี Embedding มีวิคเตอร์สำหรับแต่ละส่วนข้อความบทถอดเสียง YouTube สุดท้าย จัดเรียงผลลัพธ์ตามความคล้ายคลึงของโคไซน์และส่วนข้อความที่มีความคล้ายคลึงของโคไซน์สูงสุดคือสิ่งที่คล้ายคลึงที่สุดกับคำค้นหา

จากมุมมองทางคณิตศาสตร์ ความคล้ายคลึงของโคไซน์วัดค่าโคไซน์ของมุมระหว่างสองวิคเตอร์ที่ฉายลงในพื้นที่หลายมิติ การวัดนี้มีประโยชน์ เพราะถ้าเอกสารสองฉบับอยู่ห่างกันมากตามระยะทาง Euclidean เนื่องจากขนาด พวกเขายังอาจมีมุมที่เล็กกว่าระหว่างพวกเขาและดังนั้นมีความคล้ายคลึงของโคไซน์สูงกว่า สำหรับข้อมูลเพิ่มเติมเกี่ยวกับสมการความคล้ายคลึงของโคไซน์ ดูที่ [Cosine similarity](https://en.wikipedia.org/wiki/Cosine_similarity?WT.mc_id=academic-105485-koreyst)

## การสร้างแอปพลิเคชันการค้นหาแรกของคุณ

ต่อไป เราจะเรียนรู้วิธีสร้างแอปพลิเคชันการค้นหาโดยใช้ Embeddings แอปพลิเคชันการค้นหาจะให้นักเรียนค้นหาวิดีโอได้โดยการพิมพ์คำถาม แอปพลิเคชันการค้นหาจะคืนรายการวิดีโอที่เกี่ยวข้องกับคำถามนั้น แอปพลิเคชันการค้นหายังจะคืนลิงก์ไปยังจุดในวิดีโอที่มีคำตอบสำหรับคำถามนั้น

โซลูชันนี้ถูกสร้างและทดสอบบน Windows 11, macOS และ Ubuntu 22.04 โดยใช้ Python 3.10 หรือใหม่กว่า คุณสามารถดาวน์โหลด Python ได้จาก [python.org](https://www.python.org/downloads/?WT.mc_id=academic-105485-koreyst)

## งานที่ได้รับมอบหมาย - การสร้างแอปพลิเคชันการค้นหาเพื่อให้นักเรียนสามารถใช้งานได้

เราได้แนะนำสตาร์ทอัพของเราในตอนต้นของบทเรียนนี้ ตอนนี้ถึงเวลาที่จะให้นักเรียนสร้างแอปพลิเคชันการค้นหาสำหรับการประเมินของพวกเขา

ในงานนี้ คุณจะสร้าง Azure OpenAI Services ที่จะใช้สร้างแอปพลิเคชันการค้นหา คุณจะสร้าง Azure OpenAI Services ต่อไปนี้ คุณจะต้องมีการสมัคร Azure เพื่อทำงานนี้

### เริ่มต้น Azure Cloud Shell

1. ลงชื่อเข้าใช้ [Azure portal](https://portal.azure.com/?WT.mc_id=academic-105485-koreyst)
2. เลือกไอคอน Cloud Shell ที่มุมขวาบนของ Azure portal
3. เลือก **Bash** สำหรับประเภทของสภาพแวดล้อม

#### สร้างกลุ่มทรัพยากร

> สำหรับคำแนะนำเหล่านี้ เรากำลังใช้กลุ่มทรัพยากรที่ชื่อว่า "semantic-video-search" ใน East US
> คุณสามารถเปลี่ยนชื่อกลุ่มทรัพยากรได้ แต่เมื่อเปลี่ยนตำแหน่งสำหรับทรัพยากร
> ตรวจสอบ [ตารางความพร้อมใช้งานของโมเดล](https://aka.ms/oai/models?WT.mc_id=academic-105485-koreyst)

```shell
az group create --name semantic-video-search --location eastus
```

#### สร้างทรัพยากรบริการ Azure OpenAI

จาก Azure Cloud Shell รันคำสั่งต่อไปนี้เพื่อสร้างทรัพยากรบริการ Azure OpenAI

```shell
az cognitiveservices account create --name semantic-video-openai --resource-group semantic-video-search \
    --location eastus --kind OpenAI --sku s0
```

#### รับจุดสิ้นสุดและคีย์สำหรับการใช้งานในแอปพลิเคชันนี้

จาก Azure Cloud Shell รันคำสั่งต่อไปนี้เพื่อรับจุดสิ้นสุดและคีย์สำหรับทรัพยากรบริการ Azure OpenAI

```shell
az cognitiveservices account show --name semantic-video-openai \
   --resource-group  semantic-video-search | jq -r .properties.endpoint
az cognitiveservices account keys list --name semantic-video-openai \
   --resource-group semantic-video-search | jq -r .key1
```

#### ปรับใช้โมเดล OpenAI Embedding

จาก Azure Cloud Shell รันคำสั่งต่อไปนี้เพื่อปรับใช้โมเดล OpenAI Embedding

```shell
az cognitiveservices account deployment create \
    --name semantic-video-openai \
    --resource-group  semantic-video-search \
    --deployment-name text-embedding-ada-002 \
    --model-name text-embedding-ada-002 \
    --model-version "2"  \
    --model-format OpenAI \
    --sku-capacity 100 --sku-name "Standard"
```

## โซลูชัน

เปิด [สมุดบันทึกโซลูชัน](../../../08-building-search-applications/python/aoai-solution.ipynb) ใน GitHub Codespaces และทำตามคำแนะนำใน Jupyter Notebook

เมื่อคุณรันสมุดบันทึก คุณจะได้รับการแจ้งให้ป้อนคำค้นหา กล่องป้อนข้อมูลจะมีลักษณะดังนี้:

## ทำได้ดีมาก! เรียนรู้ต่อไป

หลังจากจบบทเรียนนี้ ลองดู [ชุดการเรียนรู้ Generative AI ของเรา](https://aka.ms/genai-collection?WT.mc_id=academic-105485-koreyst) เพื่อเพิ่มพูนความรู้เกี่ยวกับ Generative AI ของคุณ!

ไปที่บทเรียนที่ 9 ซึ่งเราจะดูวิธีการ [สร้างแอปพลิเคชันการสร้างภาพ](../09-building-image-applications/README.md?WT.mc_id=academic-105485-koreyst)!

**ข้อจำกัดความรับผิดชอบ**:  
เอกสารนี้ได้รับการแปลโดยใช้บริการแปลภาษา AI [Co-op Translator](https://github.com/Azure/co-op-translator) แม้ว่าเราจะพยายามให้การแปลมีความถูกต้อง แต่โปรดทราบว่าการแปลอัตโนมัติอาจมีข้อผิดพลาดหรือความไม่แม่นยำ เอกสารต้นฉบับในภาษาดั้งเดิมควรถูกพิจารณาเป็นแหล่งข้อมูลที่เชื่อถือได้ สำหรับข้อมูลที่มีความสำคัญ แนะนำให้ใช้บริการแปลภาษามนุษย์ที่มีความเชี่ยวชาญ เราไม่รับผิดชอบต่อความเข้าใจผิดหรือการตีความผิดที่เกิดจากการใช้การแปลนี้