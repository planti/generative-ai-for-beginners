<!--
CO_OP_TRANSLATOR_METADATA:
{
  "original_hash": "b5466bcedc3c75aa35476270362f626a",
  "translation_date": "2025-05-20T02:02:33+00:00",
  "source_file": "15-rag-and-vector-databases/data/frameworks.md",
  "language_code": "he"
}
-->
# מסגרות לרשתות נוירונים

כפי שלמדנו כבר, כדי להיות מסוגלים לאמן רשתות נוירונים ביעילות, עלינו לעשות שני דברים:

* לפעול על טנזורים, למשל להכפיל, להוסיף ולחשב פונקציות מסוימות כמו סיגמואיד או סופטמקס
* לחשב נגזרות של כל הביטויים, כדי לבצע אופטימיזציה של ירידת גרדיאנט

בעוד שספריית `numpy` יכולה לעשות את החלק הראשון, אנו זקוקים למנגנון כלשהו לחישוב נגזרות. במסגרת שפיתחנו בחלק הקודם, היינו צריכים לתכנת באופן ידני את כל פונקציות הנגזרת בתוך השיטה `backward`, שמבצעת חישוב לאחור. באופן אידיאלי, מסגרת צריכה לתת לנו את ההזדמנות לחשב נגזרות של *כל ביטוי* שנוכל להגדיר.

דבר חשוב נוסף הוא להיות מסוגלים לבצע חישובים על GPU, או כל יחידת חישוב מיוחדת אחרת, כמו TPU. אימון רשתות נוירונים עמוקות דורש *הרבה* חישובים, והיכולת להקביל את החישובים הללו על GPUs היא חשובה מאוד.

> ✅ המונח 'להקביל' מתייחס לחלוקת החישובים על פני מספר מכשירים.

כיום, שתי המסגרות הנוירוניות הפופולריות ביותר הן: TensorFlow ו-PyTorch. שתיהן מספקות API ברמת נמוכה לפעול עם טנזורים על גבי CPU ו-GPU. מעל ה-API ברמת נמוכה, יש גם API ברמת גבוהה, שנקרא Keras ו-PyTorch Lightning בהתאמה.

API ברמת נמוכה | TensorFlow| PyTorch
--------------|-------------------------------------|--------------------------------
API ברמת גבוהה| Keras| PyTorch Lightning

**APIs ברמת נמוכה** בשתי המסגרות מאפשרים לך לבנות מה שנקרא **גרפים חישוביים**. גרף זה מגדיר כיצד לחשב את התוצאה (בדרך כלל פונקציית ההפסד) עם פרמטרי הקלט הנתונים, וניתן לדחוף אותו לחישוב על GPU, אם הוא זמין. ישנן פונקציות להבדיל גרף חישובי זה ולחשב נגזרות, שניתן להשתמש בהן לאחר מכן לאופטימיזציה של פרמטרי המודל.

**APIs ברמת גבוהה** מתייחסים לרשתות נוירונים כאל **רצף של שכבות**, ומקלים מאוד על בניית רוב הרשתות הנוירוניות. אימון המודל בדרך כלל דורש הכנת הנתונים ואז קריאה לפונקציה `fit` כדי לבצע את העבודה.

ה-API ברמת גבוהה מאפשר לך לבנות רשתות נוירוניות טיפוסיות במהירות רבה מבלי לדאוג להרבה פרטים. באותו זמן, API ברמת נמוכה מציע הרבה יותר שליטה על תהליך האימון, ולכן משתמשים בו הרבה במחקר, כאשר מתמודדים עם ארכיטקטורות רשתות נוירונים חדשות.

גם חשוב להבין שאתה יכול להשתמש בשני ה-APIs יחד, למשל, אתה יכול לפתח את ארכיטקטורת השכבה של הרשת שלך באמצעות API ברמת נמוכה, ואז להשתמש בה בתוך הרשת הגדולה שנבנתה ואומנה עם ה-API ברמת גבוהה. או שאתה יכול להגדיר רשת באמצעות ה-API ברמת גבוהה כרצף של שכבות, ואז להשתמש בלולאת אימון ברמת נמוכה משלך כדי לבצע אופטימיזציה. שני ה-APIs משתמשים באותם מושגים בסיסיים, והם מתוכננים לעבוד טוב יחד.

## למידה

בקורס זה, אנו מציעים את רוב התוכן גם עבור PyTorch וגם עבור TensorFlow. אתה יכול לבחור את המסגרת המועדפת עליך ולעבור רק דרך המחברות המתאימות. אם אתה לא בטוח איזו מסגרת לבחור, קרא כמה דיונים באינטרנט על **PyTorch לעומת TensorFlow**. אתה יכול גם להסתכל על שתי המסגרות כדי לקבל הבנה טובה יותר.

כאשר אפשר, נשתמש ב-APIs ברמת גבוהה לפשטות. עם זאת, אנו מאמינים שחשוב להבין כיצד רשתות נוירונים עובדות מהיסוד, ולכן בהתחלה נתחיל בעבודה עם API ברמת נמוכה וטנזורים. עם זאת, אם אתה רוצה להתחיל מהר ולא רוצה לבזבז הרבה זמן על לימוד פרטים אלה, אתה יכול לדלג עליהם ולעבור ישר למחברות ה-API ברמת גבוהה.

## ✍️ תרגילים: מסגרות

המשך את הלמידה במחברות הבאות:

API ברמת נמוכה | מחברת TensorFlow+Keras | PyTorch
--------------|-------------------------------------|--------------------------------
API ברמת גבוהה| Keras | *PyTorch Lightning*

לאחר שליטה במסגרות, בואו נסכם את מושג ההתאמה יתרה.

# התאמה יתרה

התאמה יתרה היא מושג חשוב מאוד בלמידת מכונה, וחשוב מאוד להבין אותו נכון!

שקול את הבעיה הבאה של קירוב 5 נקודות (מיוצגות על ידי `x` בגרפים למטה):

!linear | overfit
-------------------------|--------------------------
**מודל לינארי, 2 פרמטרים** | **מודל לא לינארי, 7 פרמטרים**
שגיאת אימון = 5.3 | שגיאת אימון = 0
שגיאת ולידציה = 5.1 | שגיאת ולידציה = 20

* משמאל, אנו רואים קירוב קו ישר טוב. מכיוון שמספר הפרמטרים הוא מתאים, המודל מבין את הרעיון מאחורי התפלגות הנקודות נכון.
* מימין, המודל חזק מדי. מכיוון שיש לנו רק 5 נקודות והמודל יש לו 7 פרמטרים, הוא יכול להתאים בצורה כזו שיעבור דרך כל הנקודות, מה שגורם לשגיאת האימון להיות 0. עם זאת, זה מונע מהמודל להבין את התבנית הנכונה מאחורי הנתונים, ולכן שגיאת הוולידציה היא מאוד גבוהה.

חשוב מאוד למצוא איזון נכון בין עושר המודל (מספר הפרמטרים) למספר דוגמאות האימון.

## מדוע מתרחשת התאמה יתרה

  * לא מספיק נתוני אימון
  * מודל חזק מדי
  * יותר מדי רעש בנתוני הקלט

## כיצד לזהות התאמה יתרה

כפי שאתה יכול לראות מהגרף למעלה, ניתן לזהות התאמה יתרה על ידי שגיאת אימון מאוד נמוכה, ושגיאת ולידציה גבוהה. בדרך כלל במהלך האימון נראה גם את שגיאות האימון וגם את שגיאות הוולידציה מתחילות לרדת, ואז בנקודה מסוימת שגיאת הוולידציה עשויה להפסיק לרדת ולהתחיל לעלות. זה יהיה סימן להתאמה יתרה, והאינדיקטור לכך שעלינו כנראה להפסיק את האימון בנקודה זו (או לפחות לבצע צילום של המודל).

## כיצד למנוע התאמה יתרה

אם אתה רואה שמתרחשת התאמה יתרה, אתה יכול לעשות אחד מהבאים:

 * להגדיל את כמות נתוני האימון
 * להפחית את המורכבות של המודל
 * להשתמש בטכניקת רגולציה כלשהי, כמו Dropout, שנשקול מאוחר יותר.

## התאמה יתרה ומסחרה בין הטיה לשונות

התאמה יתרה היא למעשה מקרה של בעיה גנרית יותר בסטטיסטיקה שנקראת מסחרה בין הטיה לשונות. אם נשקול את מקורות השגיאה האפשריים במודל שלנו, נוכל לראות שני סוגי שגיאות:

* **שגיאות הטיה** נגרמות מכך שהאלגוריתם שלנו לא מסוגל ללכוד את הקשר בין נתוני האימון כראוי. זה יכול לנבוע מהעובדה שהמודל שלנו לא חזק מספיק (**התאמה חסרה**).
* **שגיאות שונות**, שנגרמות מכך שהמודל מתאים רעש בנתוני הקלט במקום קשר משמעותי (**התאמה יתרה**).

במהלך האימון, שגיאת הטיה יורדת (כשהמודל שלנו לומד להתאים את הנתונים), ושגיאת השונות עולה. חשוב להפסיק את האימון - או באופן ידני (כאשר אנו מזהים התאמה יתרה) או באופן אוטומטי (על ידי הכנסת רגולציה) - כדי למנוע התאמה יתרה.

## סיכום

בשיעור זה, למדת על ההבדלים בין ה-APIs השונים לשתי המסגרות הפופולריות ביותר ב-AI, TensorFlow ו-PyTorch. בנוסף, למדת על נושא חשוב מאוד, התאמה יתרה.

## 🚀 אתגר

במחברות המצורפות, תמצא 'משימות' בתחתית; עבוד דרך המחברות והשלם את המשימות.

## סקירה ולמידה עצמית

בצע מחקר על הנושאים הבאים:

- TensorFlow
- PyTorch
- התאמה יתרה

שאל את עצמך את השאלות הבאות:

- מה ההבדל בין TensorFlow ו-PyTorch?
- מה ההבדל בין התאמה יתרה להתאמה חסרה?

## משימה

במעבדה זו, אתה מתבקש לפתור שתי בעיות סיווג באמצעות רשתות מחוברות באופן מלא חד-שכבתיות ורב-שכבתיות באמצעות PyTorch או TensorFlow.

**כתב ויתור**:  
מסמך זה תורגם באמצעות שירות תרגום AI [Co-op Translator](https://github.com/Azure/co-op-translator). בעוד שאנו שואפים לדיוק, יש להיות מודעים לכך שתרגומים אוטומטיים עשויים להכיל שגיאות או אי דיוקים. המסמך המקורי בשפתו המקורית צריך להיחשב כמקור הסמכותי. למידע קריטי, מומלץ להשתמש בתרגום אנושי מקצועי. איננו אחראים לכל אי הבנה או פרשנות שגויה הנובעות משימוש בתרגום זה.