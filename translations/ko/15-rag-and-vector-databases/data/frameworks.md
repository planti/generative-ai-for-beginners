<!--
CO_OP_TRANSLATOR_METADATA:
{
  "original_hash": "b5466bcedc3c75aa35476270362f626a",
  "translation_date": "2025-05-20T01:53:09+00:00",
  "source_file": "15-rag-and-vector-databases/data/frameworks.md",
  "language_code": "ko"
}
-->
# 신경망 프레임워크

이미 배운 것처럼, 신경망을 효율적으로 훈련하기 위해 우리는 두 가지를 해야 합니다:

* 텐서에 대한 연산, 예를 들어 곱셈, 덧셈, 그리고 sigmoid나 softmax 같은 함수 계산
* 모든 표현식의 기울기를 계산하여 경사 하강법 최적화를 수행

`numpy` 라이브러리가 첫 번째 부분을 수행할 수 있지만, 기울기를 계산할 수 있는 메커니즘이 필요합니다. 이전 섹션에서 개발한 프레임워크에서는 `backward` 메서드 내에서 모든 미분 함수를 수동으로 프로그래밍해야 했습니다. 이상적으로는 프레임워크가 우리가 정의할 수 있는 *어떤 표현식*의 기울기도 계산할 수 있어야 합니다.

또 다른 중요한 점은 GPU나 TPU 같은 특수한 연산 장치에서 계산을 수행할 수 있는 능력입니다. 심층 신경망 훈련은 *많은* 계산을 필요로 하며, 이러한 계산을 GPU에서 병렬화할 수 있는 것이 매우 중요합니다.

> ✅ '병렬화'라는 용어는 여러 장치에 걸쳐 계산을 분배하는 것을 의미합니다.

현재 가장 인기 있는 신경망 프레임워크는 TensorFlow와 PyTorch입니다. 둘 다 CPU와 GPU에서 텐서를 다룰 수 있는 저수준 API를 제공합니다. 저수준 API 위에는 각각 Keras와 PyTorch Lightning이라는 고수준 API도 있습니다.

저수준 API | TensorFlow | PyTorch
--------------|--------------------------|------------------------
고수준 API | Keras | PyTorch Lightning

**저수준 API**는 두 프레임워크에서 **계산 그래프**를 구축할 수 있게 해줍니다. 이 그래프는 주어진 입력 매개변수로 출력(보통 손실 함수)을 계산하는 방법을 정의하며, 사용 가능한 경우 GPU에서 계산을 수행할 수 있습니다. 이 계산 그래프를 미분하고 기울기를 계산하는 함수가 있으며, 이는 모델 매개변수 최적화에 사용될 수 있습니다.

**고수준 API**는 신경망을 **층의 순서**로 간주하여 대부분의 신경망 구축을 훨씬 쉽게 만듭니다. 모델 훈련은 보통 데이터를 준비하고 `fit` 함수를 호출하여 작업을 수행합니다.

고수준 API는 많은 세부 사항을 신경 쓰지 않고 전형적인 신경망을 매우 빠르게 구축할 수 있게 해줍니다. 동시에 저수준 API는 훈련 과정에 대한 더 많은 제어를 제공하므로, 새로운 신경망 구조를 다룰 때 연구에서 많이 사용됩니다.

또한 두 API를 함께 사용할 수 있다는 것을 이해하는 것이 중요합니다. 예를 들어, 저수준 API를 사용하여 자신만의 네트워크 층 구조를 개발한 후, 고수준 API로 구축하고 훈련한 더 큰 네트워크 내에서 사용할 수 있습니다. 또는 고수준 API를 사용하여 층의 순서로 네트워크를 정의한 후, 자신만의 저수준 훈련 루프를 사용하여 최적화를 수행할 수 있습니다. 두 API는 동일한 기본 개념을 사용하며, 잘 작동하도록 설계되었습니다.

## 학습

이 과정에서는 PyTorch와 TensorFlow 모두에 대한 대부분의 콘텐츠를 제공합니다. 선호하는 프레임워크를 선택하고 해당 노트북만 학습할 수 있습니다. 어떤 프레임워크를 선택해야 할지 확신이 서지 않는다면, **PyTorch vs. TensorFlow**에 대한 인터넷의 논의를 읽어보세요. 또한 두 프레임워크를 모두 살펴보아 더 나은 이해를 얻을 수도 있습니다.

가능한 경우, 간단함을 위해 고수준 API를 사용할 것입니다. 그러나 신경망이 작동하는 방식을 처음부터 이해하는 것이 중요하다고 믿기 때문에, 처음에는 저수준 API와 텐서를 사용하여 작업을 시작합니다. 그러나 빠르게 진행하고 싶고 이러한 세부 사항을 배우는 데 많은 시간을 쓰고 싶지 않다면, 이를 건너뛰고 고수준 API 노트북으로 바로 넘어갈 수 있습니다.

## ✍️ 연습: 프레임워크

다음 노트북에서 학습을 계속하세요:

저수준 API | TensorFlow+Keras 노트북 | PyTorch
--------------|--------------------------|------------------------
고수준 API | Keras | *PyTorch Lightning*

프레임워크를 마스터한 후, 과적합의 개념을 다시 정리해봅시다.

# 과적합

과적합은 기계 학습에서 매우 중요한 개념이며, 이를 올바르게 이해하는 것이 매우 중요합니다!

다음의 5개의 점(그래프에서 `x`로 표시됨)을 근사하는 문제를 고려해봅시다:

!linear | overfit
-------------------------|--------------------------
**선형 모델, 2개의 매개변수** | **비선형 모델, 7개의 매개변수**
훈련 오류 = 5.3 | 훈련 오류 = 0
검증 오류 = 5.1 | 검증 오류 = 20

* 왼쪽에서는 좋은 직선 근사를 볼 수 있습니다. 매개변수의 수가 적절하여, 모델은 점 분포의 아이디어를 올바르게 파악합니다.
* 오른쪽에서는 모델이 너무 강력합니다. 5개의 점만 있고 모델에 7개의 매개변수가 있기 때문에, 모든 점을 통과하도록 조정할 수 있어 훈련 오류가 0이 됩니다. 그러나 이는 모델이 데이터의 올바른 패턴을 이해하지 못하게 하여 검증 오류가 매우 높아집니다.

모델의 풍부함(매개변수의 수)과 훈련 샘플의 수 사이에 올바른 균형을 맞추는 것이 매우 중요합니다.

## 과적합이 발생하는 이유

  * 충분하지 않은 훈련 데이터
  * 너무 강력한 모델
  * 입력 데이터의 너무 많은 노이즈

## 과적합을 감지하는 방법

위의 그래프에서 볼 수 있듯이, 과적합은 매우 낮은 훈련 오류와 높은 검증 오류로 감지할 수 있습니다. 일반적으로 훈련 중에는 훈련 오류와 검증 오류가 모두 감소하기 시작하고, 어느 시점에서 검증 오류가 감소를 멈추고 상승하기 시작할 수 있습니다. 이는 과적합의 신호이며, 이 시점에서 훈련을 중지해야 한다는 표시가 됩니다(또는 최소한 모델의 스냅샷을 만들어야 합니다).

## 과적합을 방지하는 방법

과적합이 발생한다고 보이면, 다음 중 하나를 수행할 수 있습니다:

 * 훈련 데이터의 양을 늘립니다
 * 모델의 복잡성을 줄입니다
 * 나중에 고려할 Dropout과 같은 규제 기법을 사용합니다.

## 과적합과 편향-분산 트레이드오프

과적합은 실제로 통계에서 편향-분산 트레이드오프라고 불리는 더 일반적인 문제의 한 사례입니다. 모델의 오류의 가능한 원인을 고려하면 두 가지 유형의 오류를 볼 수 있습니다:

* **편향 오류**는 알고리즘이 훈련 데이터 간의 관계를 올바르게 포착하지 못하여 발생합니다. 이는 모델이 충분히 강력하지 않다는 사실에서 비롯될 수 있습니다(**과소적합**).
* **분산 오류**는 모델이 입력 데이터의 노이즈를 의미 있는 관계 대신 근사함으로 인해 발생합니다(**과적합**).

훈련 중에 편향 오류는 감소하고(모델이 데이터를 근사하도록 학습함에 따라), 분산 오류는 증가합니다. 과적합을 방지하기 위해 훈련을 중지하는 것이 중요합니다 - 수동으로(과적합을 감지할 때) 또는 자동으로(규제를 도입하여).

## 결론

이 수업에서는 두 가지 가장 인기 있는 AI 프레임워크인 TensorFlow와 PyTorch에 대한 다양한 API의 차이점을 배웠습니다. 또한 매우 중요한 주제인 과적합에 대해 배웠습니다.

## 🚀 도전

동반 노트북에서는 하단에 '과제'를 찾을 수 있습니다; 노트북을 통해 작업하고 과제를 완료하세요.

## 복습 & 자기 학습

다음 주제에 대해 연구하세요:

- TensorFlow
- PyTorch
- 과적합

다음 질문을 스스로에게 물어보세요:

- TensorFlow와 PyTorch의 차이점은 무엇인가요?
- 과적합과 과소적합의 차이점은 무엇인가요?

## 과제

이 실습에서는 PyTorch 또는 TensorFlow를 사용하여 단일 및 다중 계층 완전 연결 네트워크를 사용하여 두 가지 분류 문제를 해결해야 합니다.

**면책 조항**:  
이 문서는 AI 번역 서비스 [Co-op Translator](https://github.com/Azure/co-op-translator)를 사용하여 번역되었습니다. 정확성을 위해 노력하고 있지만, 자동 번역에는 오류나 부정확한 부분이 있을 수 있습니다. 원본 문서를 권위 있는 출처로 간주해야 합니다. 중요한 정보에 대해서는 전문적인 인간 번역을 권장합니다. 이 번역의 사용으로 인해 발생하는 오해나 잘못된 해석에 대해 당사는 책임을 지지 않습니다.